extends index

block content
    if circuit
        span.hidden#circuitToken= circuit

    if devMode
        script.
            console.log("Enabling Live-Reload");
            new WebSocket(`ws://${window.location.hostname}:#{devMode}`).addEventListener('message', _ => location.reload());

    script.
        fetch('./app.js', {
            method: "HEAD"
        }).then(function (res) {
            if (res.ok)
                document.body.appendChild((function () {
                    const script = document.createElement('script');
                    script.setAttribute('src', '/app/app.js');
                    script.addEventListener('load', function () {
                        if (window.init)
                            window.init(); // This is provided by the script once it has successfully loaded.
                    });
                    return script;
                })());
            else {
                alert('The build has not finished yet. Please wait until the build finishes.')
                window.location.reload();
            }
        });

    section#body
        div#toolbar
            input#document-name(placeholder="Document Name")

        div#canvas-container

        div#status-bar
            #left
                span#grid-pos 0,0
                span#document-title ...
                span#document-id ...
            #right
                span#save-status saved
                span#owner ...
